# sub_step_types Enum

Internal mapping of Step class names to their step identifier strings. Used for workflow serialization and reconstruction.

## Description

The `sub_step_types` enum is dynamically generated by reading Step class files and extracting their static `step_name` property. This mapping is used internally by Micro Flow to:

- Serialize workflows to JSON with proper step type information
- Reconstruct step instances from serialized data
- Identify specialized step types without circular dependencies
- Support custom step classes from additional directories

### Custom Step Classes

You can extend Micro Flow with custom step classes by specifying additional directories to scan. The built-in classes directory is always included, and any additional paths specified via `workflow.sub_step_type_paths` are merged when `setWorkflow()` is called on each step.

## Structure

The enum is an object mapping class names to their step identifiers:

```javascript
{
  "Step": null,
  "ConditionalStep": "conditional",
  "LoopStep": "loop",
  "SwitchStep": "switch",
  "FlowControlStep": "flow_control",
  "SkipStep": "skip",
  "DelayStep": "delay",
  "Case": "case",
  // ... other step classes
}
```

## Import

```javascript
import SubStepTypes from 'micro-flow/enums/sub_step_types';
```

## Internal Usage

This enum is primarily for internal use by the Micro Flow library. It's automatically utilized during:

### Serialization

```javascript
// When serializing a workflow
const json = workflow.toJSON();
// Uses sub_step_types to include step class information
```

## Implementation Details

The enum is generated dynamically by:

1. Scanning the built-in classes directory (always included)
2. Scanning any additional directories specified in `workflow.sub_step_type_paths`
3. Reading all JavaScript class files (excluding `index.js`)
4. Parsing each file to extract the class name and `step_name` property
5. Resolving enum references (e.g., `logic_step_types.CONDITIONAL`)
6. Building the mapping object

This approach avoids circular dependencies that would occur if Step classes were imported directly.

### Extending with Custom Steps

To use custom step classes, add their directory paths to the workflow state:

```javascript
import { Workflow, WorkflowState } from 'micro-flow';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __dirname = dirname(fileURLToPath(import.meta.url));

const workflow = new Workflow({
  name: 'Custom Workflow'
});

// Add custom step class directories
workflow.state.set('sub_step_type_paths', [
  join(__dirname, './my-custom-steps'),
  join(__dirname, './another-step-directory')
]);

// When steps are executed, they'll scan both the built-in
// and custom directories for step class definitions
workflow.pushSteps([step1, step2]);
await workflow.execute();
```

## Relationship to logic_step_types

`sub_step_types` includes all Step classes, while `logic_step_types` only defines the specialized logic step identifiers:

```javascript
// logic_step_types (user-facing)
{
  CONDITIONAL: 'conditional',
  LOOP: 'loop',
  FLOW_CONTROL: 'flow_control',
  SWITCH: 'switch',
  SKIP: 'skip'
}

// sub_step_types (internal)
{
  "Step": null,
  "LogicStep": null,
  "ConditionalStep": "conditional",  // Maps to logic_step_types.CONDITIONAL
  "LoopStep": "loop",                // Maps to logic_step_types.LOOP
  "FlowControlStep": "flow_control", // Maps to logic_step_types.FLOW_CONTROL
  "SwitchStep": "switch",            // Maps to logic_step_types.SWITCH
  "SkipStep": "skip",                // Maps to logic_step_types.SKIP
  "DelayStep": "delay",
  "Case": "case"
}
```

## User-Facing Alternative

For typical usage, prefer `logic_step_types` enum over `sub_step_types`:

```javascript
// Prefer this (user-facing)
import { LogicStepTypes } from 'micro-flow';
console.log(LogicStepTypes.CONDITIONAL); // 'conditional'

// Over this (internal)
import SubStepTypes from 'micro-flow/enums/sub_step_types';
console.log(SubStepTypes.ConditionalStep); // 'conditional'
```

## See Also

- [logic_step_types Enum](./logic-step-types.md) - User-facing logic step types
- [step_types Enum](./step-types.md) - High-level step categories
- [Step Class](../classes/step.md) - Base step class
- [LogicStep Class](../classes/logic-step.md) - Base logic step class
